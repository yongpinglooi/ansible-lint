- name: Out-of-Place Restore Playbook
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Start Out-of-Place Restore
      commvault.ansible.request:
        webserver_hostname: "{{ http_hostname }}"
        method: POST
        url: "{0}/commandcenter/api/CreateTask"
        payload:
          taskInfo:
            associations:
              - clientName: "{{ item.client_name }}"
                backupsetName: "{{ item.user_backupset }}"
                subclientName: "{{ item.user_subclient }}"
                instanceName: "{{ item.instanceName }}"
                appName: "{{ item.appName }}"
                applicationId: {{ associate_appID }}
            task:
              taskType: 1
              initiatedFrom: 2
              policyType: 0
              taskFlags:
                disabled: false
            subTasks:
              - subTask:
                  subTaskType: 3
                  operationType: 1001
                options:
                  restoreOptions:
                    impersonation:
                      useImpersonation: false
                    virtualServerRstOption:
                      isBlockLevelReplication: false
                      isDiskBrowse: false
                      viewType: 0
                      isFileBrowse: true
                    browse
